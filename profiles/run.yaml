---
run:
  - golang:
      script: |
        wget https://go.dev/dl/go{{ .golangVersion }}.linux-amd64.tar.gz
        rm -rf /usr/local/go && tar -C /usr/local -xzf go{{ .golangVersion }}.linux-amd64.tar.gz
        rm -rf go{{ .golangVersion }}.linux-amd64.tar.gz
      vars:
        golangVersion: 1.23.4

    #   notes: |
    #     # ADD TO BASHRC
    #     export GOROOT=/usr/local/go
    #     export PATH=$GOROOT/bin:$PATH
    #     export GOPATH=$HOME/usr/local/go
    #     export PATH=$PATH:/usr/local/go/bin:$GOPATH/bin

  - age:
      script: |
        go install filippo.io/age/cmd/...@v{{ .ageVersion }}
      vars:
        ageVersion: 1.1.1

  - azure-cli:
      script: |
        curl -sL https://aka.ms/InstallAzureCLIDeb | sudo bash
  - nerdctl:
      script: |
        wget https://github.com/containerd/nerdctl/releases/download/v{{ or .nerdctlVersion "1.6.0" }}/nerdctl-full-{{ or .nerdctlVersion "1.6.0" }}-linux-amd64.tar.gz
        sudo tar Cxzvvf /usr/local nerdctl-full-{{ or .nerdctlVersion "1.6.0" }}-linux-amd64.tar.gz
        rm -rf nerdctl-full-{{ or .nerdctlVersion "1.6.0" }}-linux-amd64.tar.gz
        sudo systemctl enable --now containerd
        sudo systemctl enable --now buildkit

globals:
  golangVersion: "1.17.2"
  nerdctlVersion: "1.6.0"