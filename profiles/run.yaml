---
globals:
  binDir: "/usr/bin"
  name: machineshop

run:
  - name: golang
    description: Install Golang
    script: |
      wget https://go.dev/dl/go{{ .golangVersion }}.linux-amd64.tar.gz
      rm -rf /usr/local/go && tar -C /usr/local -xzf go{{ .golangVersion }}.linux-amd64.tar.gz
      rm -rf go{{ .golangVersion }}.linux-amd64.tar.gz
    vars:
      golangVersion: 1.23.4

  - name: dagger
    description: Install Dagger
    script: |
      curl -fsSL https://dl.dagger.io/dagger/install.sh > /tmp/install-dagger.sh
      cd &tmp && ./tmp/install-dagger.sh
      sudo mv /tmp/bin/dagger /usr/bin/dagger
      sudo chmod +x /usr/bin/dagger

  - name: age
    description: Install Age
    script: |
      go install filippo.io/age/cmd/...@v{{ .ageVersion }}
    vars:
      ageVersion: 1.1.1

  - name: hello
    description: Test output
    script: |
      echo {{ .name }}
    vars:
      name: kaeffken


  - name: azure-cli
    description: Install Azure CLI
    script: |
      curl -sL https://aka.ms/InstallAzureCLIDeb | sudo bash

  - name: nerdctl
    description: Install Nerdctl
    script: |
      wget https://github.com/containerd/nerdctl/releases/download/v{{ or .nerdctlVersion "1.6.0" }}/nerdctl-full-{{ or .nerdctlVersion "1.6.0" }}-linux-amd64.tar.gz
      sudo tar Cxzvvf /usr/local nerdctl-full-{{ or .nerdctlVersion "1.6.0" }}-linux-amd64.tar.gz
      rm -rf nerdctl-full-{{ or .nerdctlVersion "1.6.0" }}-linux-amd64.tar.gz
      sudo systemctl enable --now containerd
      sudo systemctl enable --now buildkit
    vars:
      nerdctl: 1.1.1
